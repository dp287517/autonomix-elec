<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AutonomiX — ATEX Control</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0c0f; --card:#111318; --ring:rgba(255,255,255,.08); --muted:#a3a3a3;
      --radius:16px; --glass:rgba(255,255,255,.06);
    }
    body{background:var(--bg); color:#e7e7e7}
    .topbar{ backdrop-filter: saturate(180%) blur(20px); background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
             border-bottom: 1px solid var(--ring); position: sticky; top:0; z-index:10; }
    .brand{ font-weight:700; letter-spacing:.3px; }

    .layout{ display:grid; grid-template-columns: 300px 1fr; gap:16px; }
    .panel{ background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
            border:1px solid var(--ring); border-radius: var(--radius); padding:14px; }
    .tree{ max-height: calc(100vh - 190px); overflow:auto; font-size: 14px; }
    .tree ul{ list-style:none; padding-left:16px; }
    .tree li{ margin:4px 0; }
    .node{ cursor:pointer; display:flex; align-items:center; gap:8px; }
    .badge{ border:1px solid var(--ring); background: var(--glass); color:#d6d6d6; border-radius:999px; padding:2px 8px; font-size:11px; }

    .toolbar{ display:flex; gap:8px; flex-wrap:wrap; }
    .toolbar .btn{ border-radius:10px; }
    .muted{ color:var(--muted); }

    .kv{ display:grid; grid-template-columns: 160px 1fr; gap:8px 12px; }
    .kv .key{ color:#cfcfcf; }
    .kv .val{ color:#fff; font-weight:500; }
  </style>
</head>
<body>
  <header class="topbar py-3">
    <div class="container d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center gap-3">
        <a href="dashboard.html" class="text-decoration-none text-light"><span class="brand">AutonomiX</span></a>
        <span class="badge">ATEX Control</span>
      </div>
      <div class="d-flex align-items-center gap-3">
        <span id="userBadge" class="small muted"></span>
        <button id="btnBackDash" class="btn btn-outline-light btn-sm">Tableau de bord</button>
      </div>
    </div>
  </header>

  <main class="container py-3">
    <div class="layout">
      <!-- Left: Tree / Filters -->
      <aside class="panel">
        <div class="d-flex align-items-center gap-2 mb-2">
          <input id="searchInput" type="search" class="form-control form-control-sm" placeholder="Rechercher (zone, équipement, code…)">
          <button id="btnClear" class="btn btn-outline-light btn-sm">Effacer</button>
        </div>
        <div class="tree" id="tree"></div>
      </aside>

      <!-- Right: Details -->
      <section class="panel">
        <div class="toolbar mb-3">
          <button id="btnAddEquip" class="btn btn-success btn-sm">+ Équipement</button>
          <button id="btnAddZone" class="btn btn-secondary btn-sm">+ Zone</button>
          <button id="btnExport" class="btn btn-outline-light btn-sm">Exporter CSV</button>
          <span id="selInfo" class="small muted ms-auto">Aucune sélection</span>
        </div>

        <div id="detail" class="d-none">
          <h5 id="detailTitle" class="mb-3"></h5>
          <div class="kv">
            <div class="key">Type</div><div class="val" id="detailType">—</div>
            <div class="key">Code</div><div class="val" id="detailCode">—</div>
            <div class="key">Zone</div><div class="val" id="detailZone">—</div>
            <div class="key">Dernière inspection</div><div class="val" id="detailLastInsp">—</div>
            <div class="key">Statut</div><div class="val" id="detailStatus">—</div>
          </div>
        </div>

        <div id="emptyState" class="text-center py-5">
          <div class="h5 mb-2">Sélectionne une zone ou un équipement</div>
          <div class="muted">Utilise l’arborescence à gauche pour afficher les détails.</div>
        </div>
      </section>
    </div>
  </main>

  <script>window.API_BASE_URL = window.API_BASE_URL || '';</script>
  <script src="/js/atex-control.js?v=1" defer></script>
</body>
</html>
